Some weights of the model checkpoint at /users10/zyzhang/graduationProject/data/pretrain_model/bert_base_uncased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
I am process 127044, running on gpu24: starting (Sun Mar  6 10:03:50 2022)
args.batch_size 8
args Namespace(a_imagenet_pretrain=True, a_patch_num=256, audioset_pretrain=False, bal=None, batch_size=8, data_eval='test_iemocap_dataset.json', data_train='train_iemocap_dataset.json', data_val='valid_iemocap_dataset.json', dataset='iemocap', early_stop=5, exp_dir='model_dir/compare_loss_ast_model_video_deit_iemocap', face_size=128, freqm=0, fstride=16, k=-1, label_csv='', lr=0.0001, lr_patience=2, mixup=0, modal='tav', model='ast_model_video_deit', n_class=6, n_epochs=40, n_print_steps=100, num_height=384, num_width=384, num_workers=12, optim='adam', save_model=None, scale=0, seed=1235, text_lr_factor=100, text_max_len=300, time_dim_split=True, timem=0, tstride=16, v_imagenet_pretrain=True, v_patch_num=256)
now process iemocap
---------------the train dataloader---------------
number of classes is 6
now process iemocap
---------------the evaluation dataloader---------------
number of classes is 6
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: False
frequncey stride=16, time stride=16
number of patches=512
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: False
frequncey stride=16, time stride=16
number of patches=256
Creating experiment directory: model_dir/compare_loss_ast_model_video_deit_iemocap
Now starting training for 40 epochs
running on cuda
Total parameter number is : 305.026 million
Total trainable parameter number is : 305.026 million
scheduler for iemocap is used
now training with iemocap, main metrics: acc, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f1537d801d0>
current #steps=0, #epochs=1
start training...
---------------
2022-03-06 10:04:00.248250
current #epochs=1, #steps=0
Epoch: [1][100/646]	Per Sample Total Time 0.08410	Per Sample Data Time 0.01147	Per Sample DNN Time 0.07263	Train Loss 0.4693	
Epoch: [1][200/646]	Per Sample Total Time 0.07732	Per Sample Data Time 0.00612	Per Sample DNN Time 0.07120	Train Loss 0.4364	
Epoch: [1][300/646]	Per Sample Total Time 0.07522	Per Sample Data Time 0.00433	Per Sample DNN Time 0.07089	Train Loss 0.4175	
Epoch: [1][400/646]	Per Sample Total Time 0.07423	Per Sample Data Time 0.00344	Per Sample DNN Time 0.07079	Train Loss 0.4044	
Epoch: [1][500/646]	Per Sample Total Time 0.07369	Per Sample Data Time 0.00290	Per Sample DNN Time 0.07080	Train Loss 0.3931	
Epoch: [1][600/646]	Per Sample Total Time 0.07333	Per Sample Data Time 0.00255	Per Sample DNN Time 0.07079	Train Loss 0.3848	
start validation
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
